<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

    <title>골라보세요 밸런스 게임!</title>

    <meta property="og:title" content="황금밸런스"/>
    <meta property="og:description" content="황금 밸런스를 찾아서"/>
    <meta property="og:image" content="{{ url_for('static', filename='url_docs_og.png') }}"/>

    <style>
        .product-box {
            min-width: 260px;
            max-width: 260px;

            background-color: green;
            border-radius: 10px;
            margin-top: 20px;
            margin-left: 10px;
        }

        .product-desc {

        }
    </style>

    <script>
        $(document).ready(function () {
            $('[data-toggle="popover"]').popover();
            showList_dateOrder()
        });

        function showList_dateOrder() {
            $.ajax({
                type: "GET",
                url: "api/list/dateOrder",
                data: {},
                success: function (response) {
                    let lists = JSON.parse(response['all_lists'])
                    console.log(lists)
                    let temp_html = ``

                    for (let i = 0; i < lists.length; i++)
                    {
                        let img_url_left = lists[i]['img_url_left']
                        let img_url_right = lists[i]['img_url_right']
                        let suggestion_left = lists[i]['suggestion_left']
                        let suggestion_right = lists[i]['suggestion_right']
                        let likes = lists[i]['likes']
                        let views = lists[i]['views']
                        let golden = false

                        if ((suggestion_right + suggestion_left != 0) && (Math.abs(suggestion_left-suggestion_right)/(suggestion_left+suggestion_right)*100 <= 3))
                            golden = true

                        // golden == true면 황금색 테두리리
                        if (i%3 == 0) {
                           temp_html += `<div class="row">
                                            <div class="col">
                                                <div class="product-box" onclick="show_detail()">
                                                    <div style="float: left; width:50%; height:150px; background-image: url('${img_url_left}');
                                                    background-repeat:no-repeat; background-size: cover; background-position: center top; display: flex "></div>
                                                    <div style="width:50%; height:150px; background-image: url('${img_url_right}');
                                                    background-repeat: no-repeat; background-size: cover; background-position: center top; display: flex"><div style="color: white; text-align: right; vertical-align: bottom">${likes}${views}</div></div>
                                                </div>
                                            </div>`
                        }
                        else if (i%3 == 2){
                            temp_html += `<div class="col">
                                                <div class="product-box" onclick="show_detail()">
                                                    <div style="float: left; width:50%; height:150px; background-image: url('${img_url_left}');
                                                    background-repeat:no-repeat; background-size: cover; background-position: center top; display: flex "></div>
                                                    <div style="width:50%; height:150px; background-image: url('${img_url_right}');
                                                    background-repeat: no-repeat; background-size: cover; background-position: center top; display: flex"></div>
                                                </div>
                                            </div>
                                         </div>`
                        }
                        else {
                            temp_html += `<div class="col">
                                                <div class="product-box" onclick="show_detail()">
                                                    <div style="float: left; width:50%; height:150px; background-image: url('${img_url_left}');
                                                    background-repeat:no-repeat; background-size: cover; background-position: center top; display: flex "></div>
                                                    <div style="width:50%; height:150px; background-image: url('${img_url_right}');
                                                    background-repeat: no-repeat; background-size: cover; background-position: center top; display: flex"></div>
                                                </div>
                                         </div>`
                        }
                    }

                    $('#container').empty()
                    $('#container').append(temp_html)
                }
            })
        }

        function showList_likeOrder(){
            $.ajax({
                type: "GET",
                url: "api/list/likeOrder",
                data: {},
                success: function (response) {
                    let lists = JSON.parse(response['all_lists'])
                    console.log(lists)
                    let temp_html = ``

                    for (let i = 0; i < lists.length; i++)
                    {
                        let img_url_left = lists[i]['img_url_left']
                        let img_url_right = lists[i]['img_url_right']
                        let suggestion_left = lists[i]['suggestion_left']
                        let suggestion_right = lists[i]['suggestion_right']
                        let likes = lists[i]['likes']
                        let views = lists[i]['views']
                        let golden = false

                        if ((suggestion_right + suggestion_left != 0) && (Math.abs(suggestion_left-suggestion_right)/(suggestion_left+suggestion_right)*100 <= 3))
                            golden = true

                        // golden == true면 황금색 테두리
                        if (i%3 == 0) {
                            temp_html += `<div class="row">
                                            <div class="col">
                                                <div class="product-box" onclick="show_detail()">
                                                    <div style="float: left; width:50%; height:150px; background-image: url('${img_url_left}');
                                                    background-repeat:no-repeat; background-size: cover; background-position: center top; display: flex "></div>
                                                    <div style="width:50%; height:150px; background-image: url('${img_url_right}');
                                                    background-repeat: no-repeat; background-size: cover; background-position: center top; display: flex"></div>
                                                </div>
                                            </div>`
                        }
                        else if (i%3 == 2){
                            temp_html += `<div class="col">
                                                <div class="product-box" onclick="show_detail()">
                                                    <div style="float: left; width:50%; height:150px; background-image: url('${img_url_left}');
                                                    background-repeat:no-repeat; background-size: cover; background-position: center top; display: flex "></div>
                                                    <div style="width:50%; height:150px; background-image: url('${img_url_right}');
                                                    background-repeat: no-repeat; background-size: cover; background-position: center top; display: flex"></div>
                                                </div>
                                            </div>
                                         </div>`
                        }
                        else {
                            temp_html += `<div class="col">
                                                <div class="product-box" onclick="show_detail()">
                                                    <div style="float: left; width:50%; height:150px; background-image: url('${img_url_left}');
                                                    background-repeat:no-repeat; background-size: cover; background-position: center top; display: flex "></div>
                                                    <div style="width:50%; height:150px; background-image: url('${img_url_right}');
                                                    background-repeat: no-repeat; background-size: cover; background-position: center top; display: flex"></div>
                                                </div>
                                         </div>`
                        }
                    }

                    $('#container').empty()
                    $('#container').append(temp_html)
                }
            })
        }

        function showList_goldenBalance(){
            $.ajax({
                type: "GET",
                url: "api/list/goldenBalance",
                data: {},
                success: function (response) {
                    let lists = JSON.parse(response['all_lists'])
                    console.log(lists)
                    let temp_html = ``
                    let cnt = 0

                    for (let i = 0; i < lists.length; i++)
                    {
                        let img_url_left = lists[i]['img_url_left']
                        let img_url_right = lists[i]['img_url_right']
                        let suggestion_left = lists[i]['suggestion_left']
                        let suggestion_right = lists[i]['suggestion_right']
                        let likes = lists[i]['likes']
                        let views = lists[i]['views']

                        if ((suggestion_right + suggestion_left == 0) || (Math.abs(suggestion_left-suggestion_right)/(suggestion_left+suggestion_right)*100 > 3))
                            continue

                        // border gold 추가해야함
                        if (cnt%3 == 0) {
                            temp_html += `<div class="row">
                                            <div class="col">
                                                <div class="product-box" onclick="show_detail()">
                                                    <div style="float: left; width:50%; height:150px; background-image: url('${img_url_left}');
                                                    background-repeat:no-repeat; background-size: cover; background-position: center top; display: flex "></div>
                                                    <div style="width:50%; height:150px; background-image: url('${img_url_right}');
                                                    background-repeat: no-repeat; background-size: cover; background-position: center top; display: flex"></div>
                                                </div>
                                            </div>`
                            cnt++
                        }
                        else if (cnt%3 == 2){
                            temp_html += `<div class="col">
                                                <div class="product-box" onclick="show_detail()">
                                                    <div style="float: left; width:50%; height:150px; background-image: url('${img_url_left}');
                                                    background-repeat:no-repeat; background-size: cover; background-position: center top; display: flex "></div>
                                                    <div style="width:50%; height:150px; background-image: url('${img_url_right}');
                                                    background-repeat: no-repeat; background-size: cover; background-position: center top; display: flex"></div>
                                                </div>
                                            </div>
                                         </div>`
                            cnt++
                        }
                        else {
                            temp_html += `<div class="col">
                                                <div class="product-box" onclick="show_detail()">
                                                    <div style="float: left; width:50%; height:150px; background-image: url('${img_url_left}');
                                                    background-repeat:no-repeat; background-size: cover; background-position: center top; display: flex "></div>
                                                    <div style="width:50%; height:150px; background-image: url('${img_url_right}');
                                                    background-repeat: no-repeat; background-size: cover; background-position: center top; display: flex"></div>
                                                </div>
                                         </div>`
                            cnt++
                        }
                    }

                    $('#container').empty()
                    $('#container').append(temp_html)
                }
            })
        }

        function show_detail() {
            alert("show detail!")
            $.ajax({
                type:"GET",
                url:"/detail",
                data:{},
                success: function (response){

                }
            })
        }
    </script>

</head>
<body>
    <div>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">
                <a class="navbar-brand" href="/">
                    <img src="/static/icon.jpg"  alt="황금밸런스!" width="30px" height="30px">
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="/">모든 게임 보기</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="/post" tabindex="-1">밸런스 게임 만들기</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="/login">로그인</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="/regist" tabindex="-1">회원 가입</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>


    <div>
        <button type="button" onclick="showList_dateOrder()" class="btn btn-primary">최신순</button>
        <button type="button" onclick="showList_likeOrder()" class="btn btn-primary">인기순</button>
        <button type="button" onclick="showList_goldenBalance()" class="btn btn-warning">황금밸런스만 보기</button>
        <button type="button" class="btn btn-warning" title="황금밸런스란?" data-toggle="popover" data-placement="bottom"  data-content="50:50의 비율에 가까운 상태의 게시물을 황금밸런스라고 한답니다! A와 B의 우열을 가릴 수 없는 상태라고 보면 되겠죠?">황금밸런스란?</button>
    </div>

    <div class="container" id="container">
    </div>
</body>
</html>